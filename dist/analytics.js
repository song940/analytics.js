"use strict";function Analytics(t){if(!(this instanceof Analytics))return new Analytics(t);this.config={},Object.assign(this.config,{platform:"web",api:"/analytics"},t);const e=this.get("api");this.env=env,this.utm=utm,this.cookies=cookie;var n=cookie("uuid");return n||(n=uuid(),cookie("uuid",n)),this.env.uuid=n,this.send=Analytics.createShipper(function(t,n){return Analytics.ajax(e,{env:this.env,utm:this.utm,data:t},n)}.bind(this)),this}const conn=navigator.connection;var env={ua:navigator.userAgent,url:location.href,referer:document.referrer,language:navigator.language,platform:navigator.platform,network:{downlink:conn.downlink,type:conn.effectiveType,online:navigator.onLine}};const query=t=>t.split("&").reduce((t,e)=>{const n=e.split("=");const i=n[0];const o=!n[1]||decodeURIComponent(n[1]);t[i]?Array.isArray(t[i])?t[i].push(o):t[i]=[t[i],o]:t[i]=o;return t},{});var query$1=query(location.search.slice(1)),utm=Object.keys(query$1).reduce((t,e)=>{e.startsWith("utm_")&&(t[e]=query$1[e]);return t},{});const uuid=()=>"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),cookies={};document.cookie.replace(/(.*?)=(.*?)($|;)\s?/g,function(t,e,n){cookies[unescape(e)]=unescape(n)});var cookie=(t,e)=>{if(!t)return cookies;if(!e)return cookies[t];document.cookie=escape(t)+"="+escape(e)+";"},storage=(t,e)=>{if(1===arguments.length)return(e=localStorage.getItem(t))&&(e=JSON.parse(e)),e;localStorage.setItem(t,JSON.stringify(e))};Analytics.seq=0,Analytics.prototype.__defineGetter__("seq",function(){return Date.now()+ ++Analytics.seq}),Analytics.createShipper=function(t){function e(t){n.push(t),storage("$analycits.q",n)}if("function"!=typeof t)throw new TypeError('[Analytics.js] "post" must be a function ');const n=storage("$analycits.q")||[];return setInterval(function(){const e=n.length;e&&t(n.slice(0,e),function(){n.splice(0,e),storage("$analycits.q",n)})},3e3),e},Analytics.prototype.get=function(t){return this.config[t]},Analytics.prototype.set=function(t,e){return this.config[t]=e},Analytics.prototype.track=function(t,e,n){return n=n||Date.now(),this.send({name:t,data:e,time:n})},Analytics.prototype.trackEvent=function(t,e){return this.track("$event",{name:t,event:e})},Analytics.prototype.trackPage=function(t,e,n){return t=t||location.href,e=e||document.title,n=n||document.referrer,this.trackEvent("$page",{url:t,title:e,referer:n})},Analytics.prototype.trackClick=function(t){const e=t.target;return this.trackEvent("$click",{id:e.id,href:e.href,tag:e.tagName,class:e.className,text:e.textContent})},module.exports=Analytics;
